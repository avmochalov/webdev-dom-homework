/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./api.js":
/*!****************!*\
  !*** ./api.js ***!
  \****************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addLike\": () => (/* binding */ addLike),\n/* harmony export */   \"authUser\": () => (/* binding */ authUser),\n/* harmony export */   \"commentsArray\": () => (/* binding */ commentsArray),\n/* harmony export */   \"deleteComment\": () => (/* binding */ deleteComment),\n/* harmony export */   \"formTextValue\": () => (/* binding */ formTextValue),\n/* harmony export */   \"getComment\": () => (/* binding */ getComment),\n/* harmony export */   \"isLoading\": () => (/* binding */ isLoading),\n/* harmony export */   \"postComment\": () => (/* binding */ postComment),\n/* harmony export */   \"regUser\": () => (/* binding */ regUser)\n/* harmony export */ });\n/* harmony import */ var _date_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./date.js */ \"./date.js\");\n/* harmony import */ var _main_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./main.js */ \"./main.js\");\n/* harmony import */ var _renderer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./renderer.js */ \"./renderer.js\");\nconst api = 'https://webdev-hw-api.vercel.app/api/v2/alex-mochalov/comments';\nconst authApi = 'https://webdev-hw-api.vercel.app/api/user';\nlet commentsArray = [];\nlet isLoading = false;\nlet formTextValue = String();\n\n\n\n\n\nfunction getComment() {\n    return fetch(api, {\n        method: 'GET',\n        headers: {\n            Authorization: _main_js__WEBPACK_IMPORTED_MODULE_1__.token,\n        },\n    })\n        .then((response) => {\n            return response.json();\n        })\n        .then((responseData) => {\n            console.log(responseData);\n            commentsArray = responseData.comments.map((comment) => {\n                return {\n                    name: comment.author.name,\n                    id: comment.id,\n                    date: (0,_date_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(comment.date),\n                    text: comment.text,\n                    likes: comment.likes,\n                    isLiked: comment.isLiked,\n                    likeStatus: ''\n                }\n            });\n        }).catch((error) => {\n            alert('Проверьте интернет соединение');\n        });\n}\n\nfunction postComment(text) {\n    fetch(api, {\n        method: 'POST',\n        body: JSON.stringify({\n            forceError: true,\n            text: text\n                .replaceAll(\"<\", \"&lt;\")\n                .replaceAll(\">\", \"&gt;\")\n                .replaceAll(\"QUOTE_BEGIN\", \"<div class='quote'>\")\n                .replaceAll(\"QUOTE_END\", \"</div>\"),\n        }),\n        headers: {\n            Authorization: _main_js__WEBPACK_IMPORTED_MODULE_1__.token,\n        },\n    })\n        .then((response) => {\n            if (response.status === 400) {\n                formTextValue = text\n                    .replaceAll(\"<\", \"&lt;\")\n                    .replaceAll(\">\", \"&gt;\");\n                alert('Значение полей \"Имя\" и \"Текст\" должны содержать минимум 3 символа');\n                isLoading = false;\n                (0,_renderer_js__WEBPACK_IMPORTED_MODULE_2__.commentsUploadRenderer)();\n                (0,_main_js__WEBPACK_IMPORTED_MODULE_1__.initAddForm)();\n            } else if (response.status === 500) {\n                formTextValue = text\n                    .replaceAll(\"<\", \"&lt;\")\n                    .replaceAll(\">\", \"&gt;\");\n                postComment(text);\n                // alert('Сервер сломался, попробуйте позже!');\n            }\n            else {\n                formTextValue = '';\n                getComment().then(() => {\n                    isLoading = false;\n                    (0,_main_js__WEBPACK_IMPORTED_MODULE_1__.commentsRenderer)();\n                    (0,_renderer_js__WEBPACK_IMPORTED_MODULE_2__.commentsUploadRenderer)();\n                    (0,_main_js__WEBPACK_IMPORTED_MODULE_1__.initAddForm)();\n                })\n                return response.json();\n            }\n        })\n        .then((responseData) => {\n            console.log(responseData);\n        }).catch((error) => {\n            isLoading = false;\n            formTextValue = text\n                .replaceAll(\"<\", \"&lt;\")\n                .replaceAll(\">\", \"&gt;\");\n            (0,_renderer_js__WEBPACK_IMPORTED_MODULE_2__.commentsUploadRenderer)();\n            (0,_main_js__WEBPACK_IMPORTED_MODULE_1__.initAddForm)();\n            alert('Проверьте интернет соединение');\n        });;\n}\n\nfunction authUser({ login, password }) {\n    return fetch(`${authApi}/login`, {\n        method: 'POST',\n        body: JSON.stringify({\n            login,\n            password\n        })\n    })\n        .then((response) => {\n            return response.json();\n        })\n}\n\nfunction regUser({ login, name, password }) {\n    return fetch(authApi, {\n        method: 'POST',\n        body: JSON.stringify({\n            login,\n            name,\n            password\n        })\n    })\n        .then((response) => {\n            if (response.status === 400) {\n                throw new Error('400');\n            }\n            return response.json();\n        })\n}\n\nfunction deleteComment({ id }) {\n    return fetch(api + '/' + id, {\n        method: \"DELETE\",\n        headers: {\n            Authorization: _main_js__WEBPACK_IMPORTED_MODULE_1__.token,\n        },\n    })\n        .then((response) => {\n            return response.json();\n        });\n}\n\nfunction addLike({ likeId }) {\n    console.log(likeId);\n    return fetch(api + '/' + likeId + '/toggle-like', {\n        method: \"POST\",\n        headers: {\n            Authorization: _main_js__WEBPACK_IMPORTED_MODULE_1__.token,\n        },\n    })\n        .then((response) => {\n            console.log(response);\n            return response.json();\n\n        });\n}\n\n\n//# sourceURL=webpack://webdev-dom-homework/./api.js?");

/***/ }),

/***/ "./auth-component.js":
/*!***************************!*\
  !*** ./auth-component.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"loginFromRenderer\": () => (/* binding */ loginFromRenderer)\n/* harmony export */ });\n/* harmony import */ var _api_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./api.js */ \"./api.js\");\n/* harmony import */ var _main_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./main.js */ \"./main.js\");\n/* harmony import */ var _reg_component_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./reg-component.js */ \"./reg-component.js\");\n/* harmony import */ var _renderer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./renderer.js */ \"./renderer.js\");\n\n\n\n\nfunction loginFromRenderer() {\n    window.scrollTo(0, 0);\n    _renderer_js__WEBPACK_IMPORTED_MODULE_3__.comments.innerHTML = `<div class=\"add-form\"><input type=\"text\" class=\"login__input\" placeholder=\"Логин\" />\n    <br>\n    <input type=\"password\" class=\"pwd__input\" placeholder=\"Пароль\" />\n    <button class=\"login-button\">Войти</button>\n    <button class=\"reg-button\">Зарегистрироваться</button></div>`;\n    _main_js__WEBPACK_IMPORTED_MODULE_1__.forms.innerHTML = ``;\n    document.querySelector('.reg-button').addEventListener('click', () => {\n        (0,_reg_component_js__WEBPACK_IMPORTED_MODULE_2__.regFromRenderer)();\n    });\n    document.querySelector('.login__input').addEventListener\n    document.querySelector('.login-button').addEventListener('click', () => {\n        let login = document.querySelector('.login__input').value;\n        let password = document.querySelector('.pwd__input').value;\n        if (!login || !password) {\n            alert('Поля логин и пароль не должны быть пустыми!')\n        } else {\n            (0,_api_js__WEBPACK_IMPORTED_MODULE_0__.authUser)({ login: login, password: password }).then((userData) => {\n                console.log(userData);\n                (0,_main_js__WEBPACK_IMPORTED_MODULE_1__.setToken)(`Bearer ${userData.user.token}`);\n                window.localStorage.setItem('name', `${userData.user.name}`)\n                console.log(_main_js__WEBPACK_IMPORTED_MODULE_1__.token);\n                (0,_main_js__WEBPACK_IMPORTED_MODULE_1__.appRenderer)();\n            })\n                .catch((error) => {\n                    alert('Введен неверный логин или пароль');\n                })\n        }\n    })\n}\n\n//# sourceURL=webpack://webdev-dom-homework/./auth-component.js?");

/***/ }),

/***/ "./date.js":
/*!*****************!*\
  !*** ./date.js ***!
  \*****************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction date(apiDate) {\n    let currentDate = new Date(apiDate);\n    let date = currentDate.getDate();\n    let month = currentDate.getMonth() + 1;\n    let year = String(currentDate.getUTCFullYear()).slice(2)\n    let hours = currentDate.getHours()\n    let minutes = currentDate.getMinutes()\n    if (currentDate.getDate() < 10) {\n        date = '0' + date;\n    }\n    if (currentDate.getMonth() < 10) {\n        month = '0' + month;\n    }\n    if (currentDate.getHours() < 10) {\n        hours = '0' + hours;\n    }\n    if (currentDate.getMinutes() < 10) {\n        minutes = '0' + minutes;\n    }\n    return date + '.' + month + '.' + year + ' ' + hours + ':' + minutes;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (date);\n\n//# sourceURL=webpack://webdev-dom-homework/./date.js?");

/***/ }),

/***/ "./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addCommentAnswerListener\": () => (/* binding */ addCommentAnswerListener),\n/* harmony export */   \"appRenderer\": () => (/* binding */ appRenderer),\n/* harmony export */   \"commentsRenderer\": () => (/* reexport safe */ _renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentsRenderer),\n/* harmony export */   \"commentsUploadRenderer\": () => (/* reexport safe */ _renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentsUploadRenderer),\n/* harmony export */   \"forms\": () => (/* binding */ forms),\n/* harmony export */   \"initAddForm\": () => (/* binding */ initAddForm),\n/* harmony export */   \"setToken\": () => (/* binding */ setToken),\n/* harmony export */   \"token\": () => (/* binding */ token)\n/* harmony export */ });\n/* harmony import */ var _renderer_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./renderer.js */ \"./renderer.js\");\n/* harmony import */ var _api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./api.js */ \"./api.js\");\n/* harmony import */ var _auth_component_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./auth-component.js */ \"./auth-component.js\");\nlet addFormButton;\nlet removeCommentButton;\nlet addFormName;\nlet addFormText;\nconst forms = document.querySelector('.forms');\nconst appHtml = document.querySelector('.add-form');\nlet token = window.localStorage.getItem('token');\nconsole.log(token);\n(0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.firstAppLoad)();\n\n\n\n\n\nappRenderer();\nfunction setToken(newToken) {\n    window.localStorage.setItem('token', `${newToken}`)\n    token = window.localStorage.getItem('token');\n    console.log(token);\n}\nfunction appRenderer() {\n    if (!token) {\n        (0,_api_js__WEBPACK_IMPORTED_MODULE_1__.getComment)().then(() => {\n            (0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentsRenderer)();\n            (0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentFromRenderer)({ token });\n        });\n    } else {\n        _renderer_js__WEBPACK_IMPORTED_MODULE_0__.comments.innerHTML = `<img class=\"comments__loader\" src=\"./loader2.gif\" alt=\"loader\">`;\n        (0,_api_js__WEBPACK_IMPORTED_MODULE_1__.getComment)().then(() => {\n            (0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentsRenderer)();\n            (0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentFromRenderer)({ token });\n            initAddForm();\n        });\n\n    }\n}\nfunction delay(interval = 1000) {\n    return new Promise((resolve) => {\n        setTimeout(() => {\n            resolve();\n        }, interval);\n    });\n}\nfunction fixEditField() {\n    const editField = document.querySelector('.change-form-text');\n    editField.addEventListener('click', (event) => {\n        event.stopPropagation();\n    });\n}\nfunction addCommentAnswerListener() {\n    const commentsList = document.querySelectorAll('.comment');\n    for (const comment of commentsList) {\n        comment.addEventListener('click', () => {\n            const commentIndex = comment.dataset.commentid;\n            addFormText.value = `QUOTE_BEGIN ${_api_js__WEBPACK_IMPORTED_MODULE_1__.commentsArray[commentIndex].name}  \\n  ${_api_js__WEBPACK_IMPORTED_MODULE_1__.commentsArray[commentIndex].text} QUOTE_END`;\n        });\n    }\n}\nfunction saveEventListener() {\n    const textArea = document.querySelector('.change-form-text');\n    const saveButton = document.querySelector('.save__button');\n    saveButton.addEventListener('click', (event) => {\n        event.stopPropagation();\n        const buttonIndex = saveButton.dataset.save;\n        _api_js__WEBPACK_IMPORTED_MODULE_1__.commentsArray[buttonIndex].text = textArea.value\n            .replaceAll(\"<\", \"&lt;\")\n            .replaceAll(\">\", \"&gt;\");\n        (0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentsRenderer)();\n    })\n}\nfunction editEventListener() {\n    const editButtons = document.querySelectorAll('.edit__button');\n    for (const editButton of editButtons) {\n        editButton.addEventListener('click', (event) => {\n            event.stopPropagation();\n            const buttonIndex = editButton.dataset.edit;\n            const newCommentsSet = _api_js__WEBPACK_IMPORTED_MODULE_1__.commentsArray.map((comment, index) => {\n                if (Number(buttonIndex) === index) {\n                    return `<li class=\"comment\" data-commentid='${index}'>\n        <div class=\"comment-header\">\n          <div>${comment.name}</div>\n          <div>${comment.date}</div>\n        </div>\n        <div class=\"comment-body\">\n          <textarea type=\"textarea\" class=\"change-form-text\" rows=\"4\">${comment.text}</textarea>\n        </div>\n        <div class=\"comment-footer\">\n          <button class=\"save__button\" data-save='${index}'>Сохранить</button>\n          <div class=\"likes\">\n            <span class=\"likes-counter\">${comment.likes}</span>\n            <button class=\"like-button\" data-like='${index}'></button>\n          </div>\n        </div>\n      </li>`\n                } else {\n                    return `<li class=\"comment\" data-commentid='${index}'>\n        <div class=\"comment-header\">\n          <div>${comment.name}</div>\n          <div>${comment.date}</div>\n        </div>\n        <div class=\"comment-body\">\n          <div class=\"comment-text\">\n            ${comment.text}\n          </div>\n        </div>\n        <div class=\"comment-footer\">\n          <button class=\"edit__button\" data-edit='${index}'>Редактировать</button>\n          <div class=\"likes\">\n            <span class=\"likes-counter\">${comment.likes}</span>\n            <button class=\"like-button\" data-like='${index}'></button>\n          </div>\n        </div>\n      </li>`\n                }\n            }).join('');\n            _renderer_js__WEBPACK_IMPORTED_MODULE_0__.comments.innerHTML = newCommentsSet;\n            fixEditField();\n            saveEventListener();\n            addCommentAnswerListener();\n        });\n    }\n}\n// function likeEventListener() {\n//     const likeButtons = document.querySelectorAll('.like-button');\n//     for (const likeButton of likeButtons) {\n//         likeButton.addEventListener('click', (event) => {\n//             console.log(event);\n//             event.stopPropagation();\n//             const buttonIndex = likeButton.dataset.like;\n//             likeButton.classList.add('loading-like');\n//             console.log(likeButton);\n//             delay().then(() => {\n//                 if (commentsArray[buttonIndex].isLiked === false) {\n//                     commentsArray[buttonIndex].likeStatus = '-active-like';\n//                     commentsArray[buttonIndex].likes = ++commentsArray[buttonIndex].likes;\n//                 } else {\n//                     commentsArray[buttonIndex].likeStatus = '';\n//                     commentsArray[buttonIndex].likes = --commentsArray[buttonIndex].likes;\n//                 }\n//                 commentsRenderer();\n//             })\n\n//         });\n//     }\n\n// }\nfunction checkFields() {\n    (addFormName.value.trim() != '' && addFormText.value.trim() != '') ? addFormButton.disabled = false : addFormButton.disabled = true;\n}\nfunction pushComment() {\n    if (addFormName.value === '' || addFormText.value === '') {\n        return;\n    } else {\n        forms.innerHTML = `<img class=\"loader\" src=\"./loader2.gif\" alt=\"loader\">`\n        console.log(_api_js__WEBPACK_IMPORTED_MODULE_1__.isLoading);\n        (0,_api_js__WEBPACK_IMPORTED_MODULE_1__.postComment)(addFormText.value);\n\n        addFormText.value = '';\n        addFormName.value = '';\n        addFormButton.disabled = true;\n    }\n    (0,_renderer_js__WEBPACK_IMPORTED_MODULE_0__.commentsRenderer)();\n}\nfunction removeComment() {\n    if (_renderer_js__WEBPACK_IMPORTED_MODULE_0__.comments.children.length <= 1) {\n        return;\n    } else {\n        _renderer_js__WEBPACK_IMPORTED_MODULE_0__.comments.lastElementChild.remove();\n    }\n}\nfunction initAddForm() {\n    addFormButton = document.querySelector('.add-form-button');\n    addFormName = document.querySelector('.add-form-name');\n    addFormText = document.querySelector('.add-form-text');\n    removeCommentButton = document.querySelector('.remove-form-button');\n    addFormButton.disabled = true;\n    console.log(addFormButton);\n    addFormName.addEventListener('input', checkFields);\n    addFormText.addEventListener('input', checkFields);\n    addFormButton.addEventListener('click', pushComment);\n    removeCommentButton.addEventListener('click', () => {\n        window.localStorage.clear();\n        location.reload();\n    });\n    (addFormName.value.trim().length != 0 && addFormText.value.trim().length != 0) ? addFormButton.disabled = false : addFormButton.disabled = true;\n}\ndocument.addEventListener('keyup', (event) => {\n    if (event.keyCode === 13) {\n        pushComment();\n    }\n});\n\n\n//# sourceURL=webpack://webdev-dom-homework/./main.js?");

/***/ }),

/***/ "./reg-component.js":
/*!**************************!*\
  !*** ./reg-component.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"regFromRenderer\": () => (/* binding */ regFromRenderer)\n/* harmony export */ });\n/* harmony import */ var _api_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./api.js */ \"./api.js\");\n/* harmony import */ var _auth_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth-component.js */ \"./auth-component.js\");\n/* harmony import */ var _main_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./main.js */ \"./main.js\");\n/* harmony import */ var _renderer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./renderer.js */ \"./renderer.js\");\n\n\n\n\n\nfunction regFromRenderer() {\n    _renderer_js__WEBPACK_IMPORTED_MODULE_3__.comments.innerHTML = `<div class=\"add-form\">\n    <input type=\"text\" class=\"name__input\" placeholder=\"Имя\" />\n    <br>\n    <input type=\"text\" class=\"login__input\" placeholder=\"Логин\" />\n    <br>\n    <input type=\"password\" class=\"pwd__input\" placeholder=\"Пароль\"/>\n    <button class=\"login-button\">Зарегистрироваться</button>\n    </div>`;\n    _main_js__WEBPACK_IMPORTED_MODULE_2__.forms.innerHTML = ``;\n    document.querySelector('.login-button').addEventListener('click', () => {\n        let name = document.querySelector('.name__input').value;\n        let login = document.querySelector('.login__input').value;\n        let password = document.querySelector('.pwd__input').value;\n        if (!name || !login || !password) {\n            alert('Заполните все поля');\n        } else {\n            (0,_api_js__WEBPACK_IMPORTED_MODULE_0__.regUser)({ login: login, name: name, password: password }).then((regResult) => {\n                console.log(regResult);\n                _renderer_js__WEBPACK_IMPORTED_MODULE_3__.comments.innerHTML = `<div class=\"add-form\">\n                <img src=\"./check.png\" alt=\"\" class=\"reg_img\">\n                <div class=\"reg-status\">Регистрация прошла успешно!</div>\n                </div>`\n                setTimeout(_auth_component_js__WEBPACK_IMPORTED_MODULE_1__.loginFromRenderer, 3000);\n            })\n                .catch((error) => {\n                    alert('Такой пользователь уже существует')\n                });\n        }\n\n    })\n}\n\n//# sourceURL=webpack://webdev-dom-homework/./reg-component.js?");

/***/ }),

/***/ "./renderer.js":
/*!*********************!*\
  !*** ./renderer.js ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"commentFromRenderer\": () => (/* binding */ commentFromRenderer),\n/* harmony export */   \"comments\": () => (/* binding */ comments),\n/* harmony export */   \"commentsRenderer\": () => (/* binding */ commentsRenderer),\n/* harmony export */   \"commentsUploadRenderer\": () => (/* binding */ commentsUploadRenderer),\n/* harmony export */   \"firstAppLoad\": () => (/* binding */ firstAppLoad)\n/* harmony export */ });\n/* harmony import */ var _api_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./api.js */ \"./api.js\");\n/* harmony import */ var _auth_component_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./auth-component.js */ \"./auth-component.js\");\n/* harmony import */ var _main_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./main.js */ \"./main.js\");\nconst comments = document.querySelector('.comments');\n\n\n\nlet formNameValue = window.localStorage.getItem('name');\nfunction firstAppLoad() {\n  comments.innerHTML = `<img class=\"comments__loader\" src=\"./loader2.gif\" alt=\"loader\">`\n  ;(0,_api_js__WEBPACK_IMPORTED_MODULE_0__.getComment)().then(() => {\n    commentsRenderer();\n  })\n}\nfunction commentFromRenderer({ token }) {\n  if (!token) {\n    _main_js__WEBPACK_IMPORTED_MODULE_2__.forms.innerHTML = `<div class=\"login-span\">Чтобы добавить комментарий, <span class=\"login-span-link\">авторизуйтесь!</span> </div>`\n    document.querySelector('.login-span-link').addEventListener('click', () => {\n      ;(0,_auth_component_js__WEBPACK_IMPORTED_MODULE_1__.loginFromRenderer)();\n    })\n  } else {\n    formNameValue = window.localStorage.getItem('name');\n    _main_js__WEBPACK_IMPORTED_MODULE_2__.forms.innerHTML = `     <div class=\"add-form\">\n    <input type=\"text\" disabled class=\"add-form-name\" value = '${formNameValue}' placeholder=\"Введите ваше имя\" />\n      <textarea type=\"textarea\" class=\"add-form-text\" placeholder=\"Введите ваш коментарий\" rows=\"4\">${_api_js__WEBPACK_IMPORTED_MODULE_0__.formTextValue}</textarea>\n      <div class=\"add-form-row\">\n        <button class=\"add-form-button\">Написать</button>\n        <button class=\"remove-form-button\">Выйти</button>\n      </div>\n      </div>`\n  }\n}\n\nfunction commentsUploadRenderer() {\n  if (_api_js__WEBPACK_IMPORTED_MODULE_0__.isLoading === false) {\n    _main_js__WEBPACK_IMPORTED_MODULE_2__.forms.innerHTML = `<div class=\"add-form\">\n    <input type=\"text\" disabled class=\"add-form-name\" value = '${formNameValue}' placeholder=\"Введите ваше имя\" />\n      <textarea type=\"textarea\" class=\"add-form-text\" placeholder=\"Введите ваш коментарий\" rows=\"4\">${_api_js__WEBPACK_IMPORTED_MODULE_0__.formTextValue}</textarea>\n      <div class=\"add-form-row\">\n        <button class=\"add-form-button\">Написать</button>\n        <button class=\"remove-form-button\">Выйти</button>\n      </div>\n      </div>`\n  } else {\n    _main_js__WEBPACK_IMPORTED_MODULE_2__.forms.innerHTML = `<img class=\"loader\" src=\"./loader2.gif\" alt=\"loader\">`\n    ;(0,_main_js__WEBPACK_IMPORTED_MODULE_2__.initAddForm)();\n    addFormButton.disabled = true;\n    removeCommentButton.addEventListener('click', removeComment);\n    addFormName.addEventListener('input', checkFields);\n    addFormText.addEventListener('input', checkFields);\n    addFormButton.addEventListener('click', pushComment);\n  }\n\n}\nfunction commentsRenderer() {\n  console.log(_api_js__WEBPACK_IMPORTED_MODULE_0__.commentsArray);\n  const newCommentsSet = _api_js__WEBPACK_IMPORTED_MODULE_0__.commentsArray.map((comment, index) => {\n    return `<li class=\"comment\" data-commentid='${index}'>\n        <div class=\"comment-header\">\n          <div>${comment.name}</div>\n          <div>${comment.date}</div>\n        </div>\n        <div class=\"comment-body\">\n          <div class=\"comment-text\">\n            ${comment.text}\n          </div>\n        </div>\n        <div class=\"comment-footer\">\n          <button class=\"edit__button\" ${!_main_js__WEBPACK_IMPORTED_MODULE_2__.token ? 'disabled' : ' '} data-edit='${comment.id}'>Удалить</button>\n          <div class=\"likes\">\n            <span class=\"likes-counter\">${comment.likes}</span>\n            <button class=\"like-button ${comment.isLiked ? '-active-like' : ' '} \" data-like='${comment.id}'></button>\n          </div>\n        </div>\n      </li>`\n\n  }).join('');\n  comments.innerHTML = newCommentsSet;\n  const deleteButtons = document.querySelectorAll('.edit__button');\n  // likeEventListener();\n  // editEventListener();\n  (0,_main_js__WEBPACK_IMPORTED_MODULE_2__.addCommentAnswerListener)();\n  for (const deleteButton of deleteButtons) {\n    deleteButton.addEventListener('click', (event) => {\n      event.stopPropagation();\n      const id = deleteButton.dataset.edit;\n      (0,_api_js__WEBPACK_IMPORTED_MODULE_0__.deleteComment)({ id })\n        .then((response) => {\n          (0,_api_js__WEBPACK_IMPORTED_MODULE_0__.getComment)().then(() => {\n            commentsRenderer();\n            commentsUploadRenderer();\n            (0,_main_js__WEBPACK_IMPORTED_MODULE_2__.initAddForm)();\n          })\n        })\n        .catch((error) => {\n          alert('Не удалось удалить комментарий');\n        });\n    })\n\n  }\n  const likeButtons = document.querySelectorAll('.like-button');\n  for (const likeButton of likeButtons) {\n    likeButton.addEventListener('click', (event) => {\n      likeButton.classList.add('loading-like');\n      event.stopPropagation();\n      const likeId = likeButton.dataset.like;\n      console.log(likeId);\n      (0,_api_js__WEBPACK_IMPORTED_MODULE_0__.addLike)({ likeId })\n        .then((response) => {\n          (0,_api_js__WEBPACK_IMPORTED_MODULE_0__.getComment)().then(() => {\n            commentsRenderer();\n            commentsUploadRenderer();\n            (0,_main_js__WEBPACK_IMPORTED_MODULE_2__.initAddForm)();\n          })\n        })\n    })\n  }\n}\n\n\n//# sourceURL=webpack://webdev-dom-homework/./renderer.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./main.js");
/******/ 	
/******/ })()
;